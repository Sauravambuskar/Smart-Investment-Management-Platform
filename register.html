<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - SJA Foundation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .glass-dark {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .gradient-bg-dark {
            background: linear-gradient(135deg, #2D1B69 0%, #11998e 100%);
        }
        
        .floating-shape {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            900: '#1e3a8a'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="min-h-screen transition-all duration-300 gradient-bg dark:gradient-bg-dark" id="body">
    <!-- Floating Shapes -->
    <div class="absolute inset-0 overflow-hidden">
        <div class="floating-shape absolute top-20 left-20 w-32 h-32 bg-white/10 rounded-full blur-xl"></div>
        <div class="floating-shape absolute top-40 right-32 w-24 h-24 bg-blue-400/20 rounded-full blur-lg" style="animation-delay: -2s;"></div>
        <div class="floating-shape absolute bottom-32 left-1/4 w-40 h-40 bg-purple-400/10 rounded-full blur-2xl" style="animation-delay: -4s;"></div>
        <div class="floating-shape absolute bottom-20 right-20 w-28 h-28 bg-green-400/15 rounded-full blur-lg" style="animation-delay: -1s;"></div>
    </div>

    <div class="min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 relative z-10">
        <div class="max-w-2xl w-full space-y-8">
            <!-- Header -->
            <div class="text-center">
                <h2 class="text-3xl font-bold text-white mb-2">Join SJA Foundation</h2>
                <p class="text-white/80">Create your investment account and start earning</p>
            </div>

            <!-- Registration Form -->
            <div class="glass rounded-2xl p-8 shadow-2xl">
                <form class="space-y-6" id="registerForm">
                    <!-- Referral Code (if provided) -->
                    <div id="referralSection" class="hidden">
                        <label for="referralCode" class="block text-sm font-medium text-white mb-2">
                            Referral Code
                        </label>
                        <div class="flex">
                            <input id="referralCode" name="referralCode" type="text" readonly
                                   class="flex-1 px-4 py-3 bg-white/10 border border-white/20 rounded-l-lg text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200">
                            <button type="button" id="clearReferral" class="px-4 bg-red-500 hover:bg-red-600 text-white rounded-r-lg transition-colors duration-200">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        <p class="text-sm text-green-300 mt-1">âœ“ Valid referral code applied</p>
                    </div>

                    <!-- Personal Information -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="firstName" class="block text-sm font-medium text-white mb-2">
                                First Name *
                            </label>
                            <input id="firstName" name="firstName" type="text" required 
                                   class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                   placeholder="Enter first name">
                        </div>

                        <div>
                            <label for="lastName" class="block text-sm font-medium text-white mb-2">
                                Last Name *
                            </label>
                            <input id="lastName" name="lastName" type="text" required 
                                   class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                   placeholder="Enter last name">
                        </div>
                    </div>

                    <div>
                        <label for="email" class="block text-sm font-medium text-white mb-2">
                            Email Address *
                        </label>
                        <input id="email" name="email" type="email" required 
                               class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                               placeholder="Enter your email">
                    </div>

                    <div>
                        <label for="phone" class="block text-sm font-medium text-white mb-2">
                            Phone Number *
                        </label>
                        <input id="phone" name="phone" type="tel" required 
                               class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                               placeholder="Enter phone number">
                    </div>

                    <div>
                        <label for="password" class="block text-sm font-medium text-white mb-2">
                            Password *
                        </label>
                        <div class="relative">
                            <input id="password" name="password" type="password" required 
                                   class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                   placeholder="Create a strong password">
                            <button type="button" id="togglePassword" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                <svg id="eyeIcon" class="w-5 h-5 text-white/60 hover:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                                <svg id="eyeOffIcon" class="w-5 h-5 text-white/60 hover:text-white hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"></path>
                                </svg>
                            </button>
                        </div>
                        <div class="mt-2">
                            <div class="text-xs text-white/60">
                                Password strength: <span id="passwordStrength" class="font-medium">Weak</span>
                            </div>
                            <div class="w-full bg-white/20 rounded-full h-1 mt-1">
                                <div id="strengthBar" class="bg-red-500 h-1 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <label for="confirmPassword" class="block text-sm font-medium text-white mb-2">
                            Confirm Password *
                        </label>
                        <input id="confirmPassword" name="confirmPassword" type="password" required 
                               class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                               placeholder="Confirm your password">
                        <div id="passwordMatch" class="text-xs mt-1 hidden">
                            <span class="text-red-300">Passwords do not match</span>
                        </div>
                    </div>

                    <!-- Terms and Conditions -->
                    <div class="flex items-start">
                        <input id="terms" name="terms" type="checkbox" required
                               class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-white/20 rounded bg-white/10 mt-1">
                        <label for="terms" class="ml-3 block text-sm text-white">
                            I agree to the 
                            <a href="#" class="text-blue-300 hover:text-blue-200 underline">Terms of Service</a> 
                            and 
                            <a href="#" class="text-blue-300 hover:text-blue-200 underline">Privacy Policy</a>
                        </label>
                    </div>

                    <div class="flex items-start">
                        <input id="marketing" name="marketing" type="checkbox"
                               class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-white/20 rounded bg-white/10 mt-1">
                        <label for="marketing" class="ml-3 block text-sm text-white">
                            I would like to receive marketing communications and updates
                        </label>
                    </div>

                    <div>
                        <button type="submit" 
                                class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 transform hover:scale-105">
                            <span id="registerText">Create Account</span>
                            <svg id="registerSpinner" class="hidden animate-spin -mr-1 ml-3 h-5 w-5 text-white" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                        </button>
                    </div>
                </form>

                <!-- Login Link -->
                <div class="mt-6 text-center">
                    <p class="text-white/80">
                        Already have an account?
                        <a href="login.html" class="text-blue-300 hover:text-blue-200 font-medium transition-colors duration-200">
                            Sign in here
                        </a>
                    </p>
                </div>
            </div>

            <!-- Back to Home -->
            <div class="text-center">
                <a href="index.html" class="text-white/80 hover:text-white transition-colors duration-200 inline-flex items-center">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    Back to Home
                </a>
            </div>
        </div>
    </div>

    <script>
        // Theme handling
        const currentTheme = localStorage.getItem('theme') || 'dark';
        if (currentTheme === 'dark') {
            document.getElementById('body').classList.add('dark');
        }

        // Check for referral code in URL
        const urlParams = new URLSearchParams(window.location.search);
        const referralCode = urlParams.get('ref');
        if (referralCode) {
            document.getElementById('referralSection').classList.remove('hidden');
            document.getElementById('referralCode').value = referralCode;
        }

        // Clear referral code
        document.getElementById('clearReferral').addEventListener('click', function() {
            document.getElementById('referralSection').classList.add('hidden');
            document.getElementById('referralCode').value = '';
            // Update URL without referral parameter
            const url = new URL(window.location);
            url.searchParams.delete('ref');
            window.history.replaceState({}, document.title, url);
        });

        // Password toggle
        const togglePassword = document.getElementById('togglePassword');
        const password = document.getElementById('password');
        const eyeIcon = document.getElementById('eyeIcon');
        const eyeOffIcon = document.getElementById('eyeOffIcon');

        togglePassword.addEventListener('click', function() {
            const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
            password.setAttribute('type', type);
            
            eyeIcon.classList.toggle('hidden');
            eyeOffIcon.classList.toggle('hidden');
        });

        // Password strength checker
        const strengthBar = document.getElementById('strengthBar');
        const passwordStrength = document.getElementById('passwordStrength');

        function checkPasswordStrength(password) {
            let strength = 0;
            let feedback = 'Weak';
            let color = 'bg-red-500';
            
            if (password.length >= 8) strength += 1;
            if (/[a-z]/.test(password)) strength += 1;
            if (/[A-Z]/.test(password)) strength += 1;
            if (/[0-9]/.test(password)) strength += 1;
            if (/[^A-Za-z0-9]/.test(password)) strength += 1;
            
            switch (strength) {
                case 0:
                case 1:
                    feedback = 'Weak';
                    color = 'bg-red-500';
                    break;
                case 2:
                    feedback = 'Fair';
                    color = 'bg-yellow-500';
                    break;
                case 3:
                    feedback = 'Good';
                    color = 'bg-blue-500';
                    break;
                case 4:
                case 5:
                    feedback = 'Strong';
                    color = 'bg-green-500';
                    break;
            }
            
            const percentage = (strength / 5) * 100;
            strengthBar.style.width = percentage + '%';
            strengthBar.className = `h-1 rounded-full transition-all duration-300 ${color}`;
            passwordStrength.textContent = feedback;
        }

        password.addEventListener('input', function() {
            checkPasswordStrength(this.value);
        });

        // Password confirmation
        const confirmPassword = document.getElementById('confirmPassword');
        const passwordMatch = document.getElementById('passwordMatch');

        confirmPassword.addEventListener('input', function() {
            if (password.value && confirmPassword.value) {
                if (password.value !== confirmPassword.value) {
                    passwordMatch.classList.remove('hidden');
                    confirmPassword.classList.add('border-red-500');
                } else {
                    passwordMatch.classList.add('hidden');
                    confirmPassword.classList.remove('border-red-500');
                    confirmPassword.classList.add('border-green-500');
                }
            }
        });

        // Form submission
        const registerForm = document.getElementById('registerForm');
        const registerText = document.getElementById('registerText');
        const registerSpinner = document.getElementById('registerSpinner');

        registerForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Validate passwords match
            if (password.value !== confirmPassword.value) {
                alert('Passwords do not match!');
                return;
            }
            
            // Show loading state
            registerText.textContent = 'Creating Account...';
            registerSpinner.classList.remove('hidden');
            
            const formData = new FormData(registerForm);
            const userData = {
                firstName: formData.get('firstName'),
                lastName: formData.get('lastName'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                password: formData.get('password'),
                referralCode: formData.get('referralCode') || null,
                marketing: formData.get('marketing') === 'on'
            };
            
            try {
                const response = await fetch('api/auth/register.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(userData)
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert('Account created successfully! Please check your email for verification.');
                    window.location.href = 'login.html';
                } else {
                    alert(data.message || 'Registration failed. Please try again.');
                }
            } catch (error) {
                console.error('Registration error:', error);
                alert('Registration failed. Please check your connection and try again.');
            } finally {
                // Reset button state
                registerText.textContent = 'Create Account';
                registerSpinner.classList.add('hidden');
            }
        });

        // Form validation
        const inputs = document.querySelectorAll('input[required]');
        inputs.forEach(input => {
            input.addEventListener('blur', function() {
                if (!this.value.trim()) {
                    this.classList.add('border-red-500');
                } else {
                    this.classList.remove('border-red-500');
                    this.classList.add('border-green-500');
                }
            });
        });

        // Email validation
        const emailInput = document.getElementById('email');
        emailInput.addEventListener('blur', function() {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(this.value)) {
                this.classList.add('border-red-500');
            } else {
                this.classList.remove('border-red-500');
                this.classList.add('border-green-500');
            }
        });

        // Phone validation
        const phoneInput = document.getElementById('phone');
        phoneInput.addEventListener('input', function() {
            // Remove non-digit characters
            this.value = this.value.replace(/\D/g, '');
            
            // Limit to 10 digits
            if (this.value.length > 10) {
                this.value = this.value.slice(0, 10);
            }
        });
    </script>
</body>
</html> 